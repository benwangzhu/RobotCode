&ACCESS RV2
defdat sbt_comm12_global public
;***********************************************************
;
; file Name: sbt_comm12_global.dat
;
; Copyright 2025 - 2025 speedbot All Rights reserved.
;
;
; Description:
;   Language             ==   Krl for KUKA ROBOT
;   Date                 ==   2025 - 05 - 08
;   Modification Data    ==   2025 - 05 - 08
;
; Author: speedbot
;
; Version: 1.0
;***********************************************************

;This is the socket communication configuration
decl global sock_cfg_t PolishSock = {Connected false, SockXmlName[] "SbtPolishConfig", ActFlagNo 12, RecvFlagNo 13, NByte 0, RecvTimeout 0}

;
;SbtComm012_PolishPath Global output variable
;
; Store Appr point
decl global e6pos ApprPointData[512]

; Store Appr speed [CM/MIN]
decl global int ApprSpeedData[512]

; Store Polishing point
decl global e6pos PoliPointData[2048]

; Store Grinding speed [CM/MIN]
decl global int PoliSpeedData[2048]

; Store Exit point
decl global e6pos ExitPointData[512]

; Store Exit speed [CM/MIN]
decl global int ExitSpeedData[512]

; Number of starting points
decl global int NumOfApprPoint = 0

; Store Polishing points
decl global int NumOfPoliPoint = 0

; Number of End Points
decl global int NumOfExitPoint = 0

; Tool ID code
decl global grind_head_t GrindHeadTool[4]
GrindHeadTool[1] = {Enable false, DoutputAddr 0, DinputAddr 0, BindToolNum -1, MaxGrindingSpeed 6553.5, ErrorId 0}
GrindHeadTool[2] = {Enable false, DoutputAddr 0, DinputAddr 0, BindToolNum -1, MaxGrindingSpeed 6553.5, ErrorId 0}
GrindHeadTool[3] = {Enable false, DoutputAddr 0, DinputAddr 0, BindToolNum -1, MaxGrindingSpeed 6553.5, ErrorId 0}
GrindHeadTool[4] = {Enable false, DoutputAddr 0, DinputAddr 0, BindToolNum -1, MaxGrindingSpeed 6553.5, ErrorId 0}


decl global real LastGrindSpeed[4]
LastGrindSpeed[1] = 0.0
LastGrindSpeed[2] = 0.0
LastGrindSpeed[3] = 0.0
LastGrindSpeed[4] = 0.0

decl global real CurGrindingSpeed = 0               ; Max Grinding Head Speed
decl global real MaxGrindingSpeed = 6553.5          ; Max Grinding Head Speed
decl global int GrindHeartbeatTimer = 0
decl global real SafeToolRetreatDir = 0             ; Safe Tool Retreat Direction


decl global real MaxRobStopGrindOffTime = 2.0       ; Maximum time to disable grinding head when robot is stationary [MIN]

; KEY SubCode
decl global int SEComm012Key = 0
; Manual Grinding Head Speed
decl global int ManualGrindId = 1   
decl global int CurrentActiveGrindId = 0

decl global int MaxRetryPolishTrig = 3

decl global bool GrindStaringEnable = false

; IO ADDR
; decl global int DiHeadReadyingIdx = 0
; decl global int DoRobotEnableIdx = 0
; decl global int GoHeadSpeedStartIdx = 0


;FOLD ---------------------------------------- Grinding Head Errot Signal --------------------------------------------

; global signal Gi_AlarmHead01 $in[2553] to $in[2560]            ; Current polishing head number
; global signal Gi_AlarmHead02 $in[2553] to $in[2560]            ; Current polishing head number
; global signal Gi_AlarmHead03 $in[2553] to $in[2560]            ; Current polishing head number
; global signal Gi_AlarmHead04 $in[2553] to $in[2560]            ; Current polishing head number



;ENDFOLD
enddat